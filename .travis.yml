language: node_js

node_js:
  - "10"
  - "12"

# Use container-based Travis infrastructure.
sudo: false

branches:
  only:
    - master
    # TODO(REWRITE): Remove after we release the rewrite.
    - task/rewrite

install:
  # Fail if lockfile outdated.
  # https://yarnpkg.com/lang/en/docs/cli/install/#toc-yarn-install-frozen-lockfile
  - yarn install --frozen-lockfile

notifications:
  email:
    on_success: change
    on_failure: always

script:
  # Build core library.
  - yarn run build
  # Build all examples to make sure they're not broken.
  - yarn build-examples
  # All other checks.
  - yarn run check-ci

jobs:
  include:
    - stage: documentation
      node_js: "12"
      script: echo "TODO (1) install+lint+build docs, (2) deploy"
